<!-- src/app/pages/finance.page.html -->
<div class="page">
  <!-- Totals / Pie chart -->
  <section class="card">
    <app-finance-chart [totals$]="totals$"></app-finance-chart>
  </section>

  <!-- Entry form -->
  <section class="card finance-form">
    <form (ngSubmit)="addOrUpdate()">
      <div class="grid grid-3">
        <input
          class="input"
          type="number"
          name="amount"
          [(ngModel)]="form.amount"
          placeholder="Amount"
          required
        />

        <select
          class="select"
          name="type"
          [(ngModel)]="form.type"
          required
        >
          <option value="expense">Expense</option>
          <option value="income">Income</option>
        </select>

        <input
          class="input"
          type="text"
          name="category"
          [(ngModel)]="form.category"
          placeholder="Category"
        />
      </div>

      <div class="grid grid-3">
        <input
          class="input"
          type="date"
          name="date"
          [(ngModel)]="form.date"
        />

        <input
          class="input"
          type="text"
          name="note"
          [(ngModel)]="form.note"
          placeholder="Note"
        />

        <select
          class="select"
          name="currency"
          [(ngModel)]="form.currency"
        >
          <option value="RSD">RSD</option>
          <option value="EUR">EUR</option>
          <option value="USD">USD</option>
        </select>
      </div>

      <!-- Optional: link an entry to a goal by ID (simple text for now) -->
      <div class="grid">
        <input
          class="input"
          type="text"
          name="goalId"
          [(ngModel)]="form.goalId"
          placeholder="Goal ID (optional)"
        />
      </div>

      <div class="button-row">
        <button class="btn" type="submit">
          {{ editingId ? 'Update' : 'Add Entry' }}
        </button>
        <button
          *ngIf="editingId"
          class="btn btn-ghost"
          type="button"
          (click)="cancelEdit()"
        >
          Cancel
        </button>
      </div>
    </form>
  </section>

  <!-- Entries list -->
  <section class="card">
    <h3>Entries</h3>
    <ul class="entries-list">
      <li *ngFor="let e of (entries$ | async)" class="row">
        <div class="col">{{ e.date | date:'yyyy-MM-dd' }}</div>
        <div class="col">{{ e.type }}</div>
        <div class="col">{{ e.amount }} {{ e.currency || 'RSD' }}</div>
        <div class="col">{{ e.category || '—' }}</div>
        <div class="col">{{ e.note || '—' }}</div>
        <div class="col actions">
          <button class="btn btn-ghost" type="button" (click)="edit(e)">Edit</button>
          <button class="btn btn-ghost" type="button" (click)="remove(e)">Delete</button>
        </div>
      </li>
    </ul>
  </section>
</div>
