<div class="page">
  <!-- Top bar -->
  <header class="header">
    <h2>📅 Monthly Calendar</h2>
    <div class="calendar-nav card">
      <button class="btn btn-ghost" (click)="previousMonth()">◀</button>
      <h3 class="calendar-title">{{ getMonthName(currentMonth) }} {{ currentYear }}</h3>
      <button class="btn btn-ghost" (click)="nextMonth()">▶</button>
    </div>
  </header>

  <!-- Weekday labels -->
  <div class="calendar-weekdays">
    <div *ngFor="let day of ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat']">{{ day }}</div>
  </div>

  <!-- Days grid -->
  <div class="calendar-grid">
    <div
      class="calendar-day card-subtle"
      *ngFor="let date of getDaysInMonth()"
      [class.selected]="isSelected(date)"
      (click)="selectDate(date)"
    >
      <strong>{{ date.getDate() }}</strong>
      <ul *ngIf="reminders[format(date)]?.length">
        <li *ngFor="let r of reminders[format(date)] trackBy: trackById">
          <span>{{ r.time ? r.time + ' - ' : '' }}{{ r.message }}</span>
        </li>
      </ul>
    </div>
  </div>

  <!-- Add reminder form -->
  <section *ngIf="selectedDate" class="card reminder-form">
    <h3>➕ Add Reminder for {{ selectedDate }}</h3>
    <input class="input" [(ngModel)]="newReminder" placeholder="Reminder text..." />
    <div class="reminder-options">
      <input class="input" [(ngModel)]="reminderTime" type="time" />
      <label class="checkbox-row">
        <input type="checkbox" [(ngModel)]="sendEmail" />
        Send email reminder
      </label>
      <button class="btn" (click)="addReminder()">Add</button>
    </div>
  </section>

  <!-- Reminders list -->
  <section *ngIf="selectedDate && reminders[selectedDate]?.length" class="card reminder-list">
    <h4>📌 Reminders for {{ selectedDate }}:</h4>
    <ul>
      <li *ngFor="let r of reminders[selectedDate] trackBy: trackById">
        <span>{{ r.time ? r.time + ' - ' : '' }}{{ r.message }}</span>
        <button class="btn btn-ghost danger" (click)="deleteReminderById(r.id, selectedDate)">X</button>
      </li>
    </ul>
  </section>

  <!-- Manual email reminder -->
  <section class="card email-reminder-form">
    <h3>📤 Send Manual Email Reminder</h3>
    <label>Message:</label>
    <input class="input" [(ngModel)]="reminderText" type="text" placeholder="Reminder message" />
    <button class="btn" (click)="sendEmailReminder()">Send</button>
  </section>
</div>
